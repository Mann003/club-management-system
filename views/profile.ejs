<!DOCTYPE html>
<!-- Created by CodingLab |www.youtube.com/CodingLabYT-->
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <title> IIITL-Clubs </title>
  <link rel="stylesheet" href="/css/profile.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Boxiocns CDN Link -->
  <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <div class="sidebar close">
    <div class="logo-details">
      <img src="/images/Website Logo/IIITL.png" style="margin-left: 12px;" alt="" height="50px" width="50px">
      <span class="logo_name">IIITL Clubs</span>
    </div>
    <ul class="nav-links">
      <li>
        <a href="#">
          <i class='bx bx-grid-alt'></i>
          <span class="link_name">Announcements</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Discussion</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-collection'></i>
            <span class="link_name">Discussion</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Discussion</a></li>
          <li><a href="#">Events & Ideas</a></li>
          <li><a href="#">Editing</a></li>
          <li><a href="#">Chill</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-book-alt'></i>
            <span class="link_name">Posts</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Posts</a></li>
          <li><a href="#">Ideas</a></li>
          <li><a href="#">Post Design</a></li>
          <li><a href="#">Content</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-pie-chart-alt-2'></i>
          <span class="link_name">Analytics</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Analytics</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-line-chart'></i>
          <span class="link_name">Contribution</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Contribution</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-plug'></i>
            <span class="link_name">Plugins</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Plugins</a></li>
          <li><a href="#">UI Face</a></li>
          <li><a href="#">Pigments</a></li>
          <li><a href="#">Box Icons</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-compass'></i>
          <span class="link_name">Explore</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Explore</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-history'></i>
          <span class="link_name">History</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">History</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-cog'></i>
          <span class="link_name">Setting</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Setting</a></li>
        </ul>
      </li>
      <li>
        <div class="profile-details">
          <div class="profile-content">
            <!--<img src="image/profile.jpg" alt="profileImg">-->
          </div>
          <div class="name-job">
            <div class="profile_name">
              <%= user.firstname %>
            </div>
            <div class="job">
              <%= user.club %>
            </div>
          </div>
          <a href="/logout"><i class='bx bx-log-out'></i></a>
        </div>
      </li>
    </ul>
  </div>
  <section class="home-section">
    <div class="home-content">
      <i class='bx bx-menu'></i>
      <span class="text">Club Management System</span>
      <!-- <input type="text" id="message" name="message" /> -->
      <section style="background-color: #CDC4F9;" class="overflow-hidden">
        <div class="container py-5 overflow-hidden">

          <div class="row">
            <div class="col-md-12">

              <div class="card" id="chat3" style="border-radius: 15px;">
                <div class="card-body chat">

                  <div class="row">
                    <div class="col-md-6 col-lg-5 col-xl-4 mb-4 mb-md-0">

                      <div class="p-3">

                        <div class="input-group rounded mb-3">
                          <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search"
                            aria-describedby="search-addon" />
                          <span class="input-group-text border-0" id="search-addon">
                            <i class="fas fa-search"></i>
                          </span>
                        </div>

                        <div data-mdb-perfect-scrollbar="" style="position: relative; height: 400px"
                          class="overflow-auto">
                          <ul class="list-unstyled mb-0">
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Afterdark</p>
                                    <p class="small text-muted">Hello, Are you there?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1">Just now</p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Zephyr</p>
                                    <p class="small text-muted">What's the status?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1">Yesterday</p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Crotonia</p>
                                    <p class="small text-muted">Any updates?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1"></p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Utkrhist</p>
                                    <p class="small text-muted">Everything's good?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1">3 days ago</p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Afterdark</p>
                                    <p class="small text-muted">Hello, Are you there?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1">Just now</p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Afterdark</p>
                                    <p class="small text-muted">Hello, Are you there?</p>
                                  </div>
                                  <div class="pt-1">
                                    <p class="small text-muted mb-1">Just now</p>
                                  </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-between ">
                                  <a href="#">
                                  </a>
                                  <a href="/chat/afterdark" class="">
                                    <img src="/images/illustrations/zoom.png" alt="" width="30px" height="30px">
                                  </a>
                                </div>
                              </a>
                            </li>
                            <!-- <li class="p-2 border-bottom">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Satyabrat</p>
                                    <p class="small text-muted">Hello, Are you there?</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">Just now</p>
                                  <span class="badge bg-danger rounded-pill float-end">3</span>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava2-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-warning badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Ayush Ranjan</p>
                                    <p class="small text-muted">What's up man!!</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">5mins ago</p>
                                  <span class="badge bg-danger rounded-pill float-end">2</span>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Kunvar Snehil</p>
                                    <p class="small text-muted">wanna hang out?</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">Yesterday</p>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava4-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-danger badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Ashleysha</p>
                                    <p class="small text-muted">Need some help.</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">Yesterday</p>
                                </div>
                              </a>
                            </li>
                            <li class="p-2 border-bottom">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava5-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-warning badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Ahmad maaz</p>
                                    <p class="small text-muted">Wanna smoke.</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">Yesterday</p>
                                </div>
                              </a>
                            </li> -->
                            <!-- <li class="p-2">
                              <a href="#!" class="d-flex justify-content-between">
                                <div class="d-flex flex-row">
                                  <div>
                                    <img
                                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava6-bg.webp"
                                      alt="avatar" class="d-flex align-self-center me-3" width="60">
                                    <span class="badge bg-success badge-dot"></span>
                                  </div>
                                  <div class="pt-1">
                                    <p class="fw-bold mb-0">Ben Smith</p>
                                    <p class="small text-muted">call me dude!</p>
                                  </div>
                                </div>
                                <div class="pt-1">
                                  <p class="small text-muted mb-1">Yesterday</p>
                                </div>
                              </a>
                            </li> -->
                          </ul>
                        </div>

                      </div>

                    </div>

                    <iframe class="col-md-6 col-lg-7 col-xl-8 position-relative" src="http://localhost:3001"
                      frameborder="0"></iframe>
                  </div>

                </div>
              </div>

            </div>
          </div>

        </div>
      </section>
    </div>
  </section>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    let arrow = document.querySelectorAll(".arrow");
    for (var i = 0; i < arrow.length; i++) {
      arrow[i].addEventListener("click", (e) => {
        let arrowParent = e.target.parentElement.parentElement;//selecting main parent of arrow
        arrowParent.classList.toggle("showMenu");
      });
    }
    let sidebar = document.querySelector(".sidebar");
    let sidebarBtn = document.querySelector(".bx-menu");
    console.log(sidebarBtn);
    sidebarBtn.addEventListener("click", () => {
      sidebar.classList.toggle("close");
    });
  </script>
  <script>
    function setCookie(name, value, days) {
      var expires = "";
      if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getCookie(name) {
      var nameEQ = name + "=";
      var ca = document.cookie.split(';');
      for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }
    function eraseCookie(name) {
      document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
    var test = '<%- user.email %>';
    eraseCookie('user');
    setCookie('user', test, 1);
    localStorage.setItem('userEmail', test);
    const socket = io();

    const messages = [
      // {
      //   me: true,
      //   message: "Hi"
      // },
      // {
      //   me: false,
      //   message: "Hey"
      // }
    ]

    const mssgbox = document.querySelector('#message');
    const holder = document.querySelector('.message-holder');

    mssgbox.addEventListener('keydown', (event) => {
      if (event.key == 'Enter' && event.target.value) {
        console.log("sending data")
        updateChat(event.target.value, true)
        socket.emit('chat-sent', event.target.value)
      }
    })

    socket.on('sent-response', (data) => {
      console.log(data);

    })

    socket.on('update-chat', (data) => {
      updateChat(data, false);
    })

    const updateChat = (data, isMe) => {
      holder.innerHTML = "";
      messages.push({
        me: isMe,
        message: data,
      })
      messages.forEach((element, index) => {
        if (element.me) {
          holder.insertAdjacentHTML("beforeend", `
          <div class="d-flex flex-row justify-content-end">
            <div>
              <p class="small p-2 me-3 mb-1 text-white rounded-3 bg-primary">${element.message}</p>
              <p class="small me-3 mb-3 rounded-3 text-muted">12:00 PM | Aug 13</p>
            </div>
            <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
              alt="avatar 1" style="width: 45px; height: 100%;">
          </div
          `);
        } else {
          holder.insertAdjacentHTML("beforeend", `
          <div class="d-flex flex-row justify-content-start">
              <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava6-bg.webp"
                alt="avatar 1" style="width: 45px; height: 100%;">
              <div>
                <p class="small p-2 ms-3 mb-1 rounded-3" style="background-color: #f5f6f7;">${element.message}</p>
                <p class="small ms-3 mb-3 rounded-3 text-muted float-end">12:00 PM | Aug 13</p>
              </div>
            </div>
          </div
          `);
        }
      });
    }

  </script>
</body>

</html>